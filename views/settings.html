<% extends 'layout.html' %>

<% block content %>
  <h1><%= 'Settings' %></h1>

  <div id="mailpoet_settings"></div>

  <script src="https://fb.me/JSXTransformer-0.13.3.js"></script>

  <script type="text/jsx">
    var settings = {
      firstname: "Default",
      lastname: null,
      email: null
    }
    var FormFields = React.createClass({
      render: function() {
        console.log('render', this.props);
        return (
          <div>
            <p>
              <label><%= __('First Name') %></label>
              <input type="text" ref="firstname"
                defaultValue={this.props.settings.firstname} />
            </p>

            <p>
              <label><%= __('Last Name') %></label>
              <input type="text" ref="lastname"
                defaultValue={this.props.settings.lastname} />
            </p>

            <p>
              <label><%= __('Email') %></label>
              <input type="email" ref="email"
                defaultValue={this.props.settings.email} />
            </p>

            <a className="button button-primary"
              onClick={this.save}><%= __('Save') %></a>
          </div>
        );
      },
      save: function(e) {
        e.preventDefault();

        // Get values via this.refs
        var data = {
          firstname: this.refs.firstname.getDOMNode().value,
          lastname: this.refs.lastname.getDOMNode().value,
          email: this.refs.email.getDOMNode().value,
        };
        console.log(data);
      }
    });

    React.render(
      <FormFields settings={settings} />,
      document.getElementById('mailpoet_settings')
    );
  </script>

  <script type="text/javascript">

  jQuery(function($) {
    $(function() {
      $.ajax({
        url: ajaxurl,
        type: 'post',
        data: {
          action: 'mailpoet',
          token: mailpoet_token,
          endpoint: 'settings',
          method: 'get',
          args: {
            first_name: 'John'
          }
        },
        success : function(response) {

        }
      });
    });
  });
  </script>
<% endblock %>
